<?php

{{ builderInfo.php|raw }}

namespace {{ thisWidget.namespace }};

class {{ thisWidget.class }} extends \ADIOS\Core\Widget {
  public function onBeforeRender() {
    if (
      $this->adios->controllerObject::class == "ADIOS\\Controllers\\Desktop"
      && $this->adios->hasPermissionsForController("{{ thisWidget.name }}")
    ) {
      $desktop = $this->adios->controllerObject;

{% for itemTitle, itemConfig in thisWidget.config.sidebar %}
      $desktop->addSidebarItem($this, [
        "fa_icon" => "fas {% if itemConfig.faIcon %}{{ itemConfig.faIcon }}{% else %}{{ thisWidget.config.faIcon }}{% endif %}",
        "title" => "{{ itemTitle }}",
        "custom_title" => "{{ itemConfig.customTitle|raw }}",
{% if itemConfig.url %}
        "onclick" => "desktop_update('{{ itemConfig.url }}');",
{% endif %}
{% if itemConfig.sub is iterable %}
        "sub" => [
{% for subItemTitle, subItemConfig in itemConfig.sub %}
          [
            "title" => "{{ subItemTitle }}",
            "onclick" => "desktop_update('{{ subItemConfig.url }}');",
          ],
{% endfor %}
        ],
{% endif %}
      ]);
{% endfor %}
    }
  }
}
