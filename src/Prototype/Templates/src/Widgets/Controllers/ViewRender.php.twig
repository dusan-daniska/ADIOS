<?php

{{ builderInfo.php|raw }}

namespace {{ thisController.namespace }};

class {{ thisController.class }} extends \ADIOS\Core\Widget\Controller {

  use \{{ thisController.traitNamespace }}\{{ thisController.class }};

  public function prepareViewAndParams(): array {

    // prepare view
    $this->view = '{{ thisController.config.view }}';

    // call onBeforePrepareViewAndParams, if it exists
    if (method_exists($this, 'onBeforePrepareViewAndParams')) {
      $this->onBeforePrepareViewAndParams();
    }

    // build-up view params
    $this->viewParams = array_merge(
      $this->params,
      [
        'windowParams' => $this->params['windowParams'] ?? [],
      ],
{{ varExport(thisController.config.params, "      ")|raw }} ?? []
    );

    // call onAfterPrepareViewAndParams, if it exists
    if (method_exists($this, 'onAfterPrepareViewAndParams')) {
      $this->onAfterPrepareViewAndParams();
    }

    // render view
    return [$this->view, $this->viewParams];
  }
}
